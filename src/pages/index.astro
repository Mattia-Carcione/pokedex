---
import { LINKS_API, SITE_TITLE } from "../const";
import Layout from "../layouts/Layout.astro";
import IndexSection from "../components/layouts/IndexSection.astro";
import type { GenerationInfo, NameUrl, PokeApi } from "../utils/interfaces/types";
import { getPokemonData } from "../utils/helpers/getDataJson";

const link = LINKS_API.find((x) => x.id == "generation");
  const dataApi: NameUrl[] = [
    {
      name: link!.label,
      url: link!.href,
    },
  ];
const data = await getPokemonData(dataApi, "generations.json") as PokeApi[];
const genData = await Promise.all(data.map(async (gen) => {
    const response = await getPokemonData(gen.results, "generationData.json");
    return response.flat() as GenerationInfo[];
}));
const species = genData.flat().find(x => x.id == 1)?.pokemon_species;
const path = ["pokemonDataGen1.json", "pokemonSpeciesDataGen1.json"];
---

<Layout title={SITE_TITLE} heroTitle="PoKÃ©Dex" description="" isHome={true}>
    <IndexSection species={species} path={path} />
</Layout>
